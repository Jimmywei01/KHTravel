{"version":3,"sources":["xhr.js"],"names":["selectData","xhr","XMLHttpRequest","open","send","onload","readyState","status","callback","JSON","parse","responseText","result","records","xhrData","value","areaValue","i","length","selectArea","Zone","push","iterable","Set","area","document","querySelector","oldNode","newNode","createElement","areaText","createTextNode","appendChild","strData","areaTitle","row","select","addEventListener","e","target","btns","nodeName","str","innerHTML","Picture1","Name","Opentime","Add","Tel","Ticketinfo"],"mappings":"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","file":"xhr.js","sourcesContent":["\n let selectData = []\n let xhr = new XMLHttpRequest()\n xhr.open('get', 'https://data.kcg.gov.tw/api/action/datastore_search?resource_id=92290ee5-6e61-456f-80c0-249eae2fcc97', true)\n xhr.send()\n xhr.onload = function () {\n   if (xhr.readyState === 4 && xhr.status === 200) {\n     let callback = JSON.parse(xhr.responseText)\n     selectData = callback.result.records\n     // 把 load 回來的資料從 xhr 傳出去做處理\n     xhrData()\n   }\n }\n\n// set 寫法 篩選地區名\n// 接到 xhrData 處理 select下拉選單\nlet value = []\nfunction xhrData() {  \n  let areaValue = []\n  for (let i = 0; i < selectData.length; i++) {\n    const selectArea = selectData[i].Zone\n    areaValue.push(selectArea)\n  }\n  // 用 set 把多餘的地區值移除\n  let iterable = new Set(areaValue)\n  for (let value of iterable) {\n     // append 到 select 選單\n     const area = document.querySelector('.area')\n     const oldNode = document.querySelector('option')\n     const newNode = document.createElement('option')\n     let areaText = document.createTextNode(value)\n     newNode.appendChild(areaText)\n     area.appendChild(newNode, oldNode)\n    strData()\n  }\n}\n\n// 地區名\n let areaTitle = document.querySelector('.areaTitle')\n\n// 選擇行政區資訊\n let row = document.querySelector('.row')\n \n// 選擇行政區\n let select = document.querySelector('.area')\n select.addEventListener('change', function(e){\n    value = e.target.value   // 篩選後的直帶入當作 value 為了之後的info比對\n    strData()\n }, false)\n\n//  // 熱門行政區 點選顯示區域資料\n//  // 多子選項必須要先拿出來才能選擇 否則 addEventlistener 錯誤\n//  let btns = document.querySelectorAll('.btn')\n//  for (let i = 0; i < btns.length; i++) {\n//    btns[i].addEventListener('click', function(e){\n//      value = e.target.value // 篩選後的值帶入當作 value 為了之後的info比對\n//      strData()\n//    }, false)\n//  }\n\n // 改寫 由父元素裡頭監聽裡頭子元素的作法。好處就是效能較好，網頁上不會有太多監聽影響效能。\nlet btns = document.querySelector('.starArea')\n btns.addEventListener('click',function(e){\n   if (e.target.nodeName !== \"BUTTON\"){return}\n   value=e.target.value\n   strData()\n },false)\n\n\n\n\n \n \n function strData() {\n  let str = ' ' // 取出變數為單一地區值，不取出則在選擇到另外一個區域，區域值會累加\n   for (let i = 0; i < selectData.length; i++) {\n     if (value === selectData[i].Zone) {\n      areaTitle.innerHTML = `${selectData[i].Zone}`\n       str +=\n         ` \n           <div class=\"boxCard\">\n          <div class=\"cover\">\n            <img src=\"${selectData[i].Picture1}\" alt=\"none\">\n          </div>\n          <div class=\"barInfo\">\n            <h3 class=\"cTitle\">${selectData[i].Name}</h3>\n            <div class=\"barName\">${selectData[i].Zone}</div>\n          </div>\n          <div class=\"areaInfo\">\n            <div class=\"time\">${selectData[i].Opentime}</div>\n            <div class=\"add\">${selectData[i].Add}</div>\n            <div class=\"phone\">${selectData[i].Tel}</div>\n          </div>\n          <div class=\"ticket\">${selectData[i].Ticketinfo}</div>\n        </div> \n    `\n     }\n   }\n   row.innerHTML = str\n }\n"]}