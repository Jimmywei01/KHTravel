{"version":3,"sources":["xhr.js"],"names":["selectData","xhr","XMLHttpRequest","open","callback","JSON","parse","responseText","result","records","xhrData","value","areaValue","i","length","selectArea","Zone","push","iterable","Set","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","Symbol","iterator","next","done","area","document","querySelector","oldNode","newNode","createElement","areaText","createTextNode","appendChild","strData","err","return","areaTitle","select","addEventListener","e","target","btns","querySelectorAll","str","innerHTML","Picture1","Name","Add","Tel","Ticketinfo"],"mappings":"aACA,IAAAA,WAAA,GAAAC,IAAA,IAAAC,eACAD,IAAAE,KAAA,MAAA,wGAAA,GACAF,IAAAA,OACAA,IAAAA,OAAAA,WACAA,GAAAA,IAAAA,IAAAA,YAAAA,MAAAA,IAAAA,OAAAA,CACA,IAAAG,EAAAC,KAAAC,MAAAL,IAAAM,cACAP,WAAAI,EAAAI,OAAAC,QAEAC,YAMA,IAAAC,MAAA,GACA,SAAAD,UAEA,IADA,IAAAE,EAAA,GACAC,EAAA,EAAAA,EAAAb,WAAAc,OAAAD,IAAA,CACA,IAAAE,EAAAf,WAAAa,GAAAG,KACAJ,EAAAK,KAAAF,GAGA,IAAAG,EAAA,IAAAC,IAAAP,GAPAQ,GAAA,EAAAC,GAAA,EAAAC,OAAAC,EAAA,IAQA,IAAA,IAAAC,EAAAC,EAAAP,EAAAQ,OAAAC,cAAAP,GAAAI,EAAAC,EAAAG,QAAAC,MAAAT,GAAA,EAAA,CAAA,IAAAT,EAAAa,EAAAb,MAPAmB,EAAAC,SAAAC,cAAA,SAAAC,EAAAF,SAAAC,cAAA,UAYAE,EAAAH,SAAAI,cAAA,UAZAC,EAAAL,SAAAM,eAAA1B,GAQAuB,EAAAI,YAAAF,GAAAN,EAAAQ,YAAAJ,EAAAD,GAQAM,WAjBA,MAAAC,GAAAnB,GAAA,EAAAC,EAAAkB,EAAA,QAAA,KAAApB,GAAAK,EAAAgB,QAAAhB,EAAAgB,SAAA,QAAA,GAAApB,EAAA,MAAAC,IAcA,IAAAoB,UAAAX,SAAAC,cAAA,cAGAO,IAAAA,SAAAA,cAAAA,QAhBAI,OAAAZ,SAAAC,cAAA,SAAAW,OAAAC,iBAAA,SAAA,SAAAC,GAAAlC,MAAAkC,EAAAC,OAAAnC,MAAA4B,WAAA,SAAA,IAAA,IAAAQ,KAAAhB,SAAAiB,iBAAA,QAAAnC,EAAA,EAAAA,EAAAkC,KAAAjC,OAAAD,IAAAkC,KAAAlC,GAAA+B,iBAAA,QAAA,SAAAC,GAAAlC,MAAAkC,EAAAC,OAAAnC,MAAA4B,WAkBA,SAKA,SAAAA,UAwBA,IAvBA,IAAAU,EAAA,IAuBApC,EAAA,EAAAA,EAAAb,WAAAc,OAAAD,IArBAF,QAAAX,WAAAa,GAAAG,OACA0B,UAAAQ,UAAA,GAAAlD,WAAAa,GAAAG,KACA2B,GAAAA,6FA0BA3C,WAAAa,GAAAsC,SA1BAR,oGAOA3C,WAAAa,GAAAuC,KAPAT,2CAQA3C,WAAAa,GAAAG,KARA2B,6FAWAJ,WAAAA,GAAAA,SAXAI,wCAYA3C,WAAAa,GAAAwC,IAZAV,0CAaA3C,WAAAa,GAAAyC,IAbAX,2DAiBA3C,WAAAa,GAAA0C,WAjBAZ,iCAsBAM,IAAAA,UAAAA","file":"xhr.js","sourcesContent":["\n let selectData = []\n let xhr = new XMLHttpRequest()\n xhr.open('get', 'https://data.kcg.gov.tw/api/action/datastore_search?resource_id=92290ee5-6e61-456f-80c0-249eae2fcc97', true)\n xhr.send()\n xhr.onload = function () {\n   if (xhr.readyState === 4 && xhr.status === 200) {\n     let callback = JSON.parse(xhr.responseText)\n     selectData = callback.result.records\n     // 把 load 回來的資料從 xhr 傳出去做處理\n     xhrData()\n   }\n }\n\n// set 寫法 篩選地區名\n// 接到 xhrData 處理 select下拉選單\nlet value = []\nfunction xhrData() {  \n  let areaValue = []\n  for (let i = 0; i < selectData.length; i++) {\n    const selectArea = selectData[i].Zone\n    areaValue.push(selectArea)\n  }\n  // 用 set 把多餘的地區值移除\n  let iterable = new Set(areaValue)\n  for (let value of iterable) {\n     // append 到 select 選單\n     const area = document.querySelector('.area')\n     const oldNode = document.querySelector('option')\n     const newNode = document.createElement('option')\n     let areaText = document.createTextNode(value)\n     newNode.appendChild(areaText)\n     area.appendChild(newNode, oldNode)\n    strData()\n  }\n}\n\n// 地區名\n let areaTitle = document.querySelector('.areaTitle')\n\n// 選擇行政區資訊\n let row = document.querySelector('.row')\n \n// 選擇行政區\n let select = document.querySelector('.area')\n select.addEventListener('change', function(e){\n    value = e.target.value   // 篩選後的直帶入當作 value 為了之後的info比對\n    strData()\n }, 'false')\n\n // 熱門行政區 點選顯示區域資料\n // 多子選項必須要先拿出來才能選擇 否則 addEventlistener 錯誤\n let btns = document.querySelectorAll('.btn')\n for (let i = 0; i < btns.length; i++) {\n   btns[i].addEventListener('click', function(e){\n     value = e.target.value // 篩選後的值帶入當作 value 為了之後的info比對\n     strData()\n   }, 'false')\n }\n\n \n \n function strData() {\n  let str = ' ' // 取出變數為單一地區值，不取出則在選擇到另外一個區域，區域值會累加\n   for (let i = 0; i < selectData.length; i++) {\n     if (value === selectData[i].Zone) {\n      areaTitle.innerHTML = `${selectData[i].Zone}`\n       str +=\n         ` \n           <div class=\"boxCard\">\n          <div class=\"cover\">\n            <img src=\"${selectData[i].Picture1}\" alt=\"none\">\n          </div>\n          <div class=\"barInfo\">\n            <h3 class=\"cTitle\">${selectData[i].Name}</h3>\n            <div class=\"barName\">${selectData[i].Zone}</div>\n          </div>\n          <div class=\"areaInfo\">\n            <div class=\"time\">${selectData[i].Opentime}</div>\n            <div class=\"add\">${selectData[i].Add}</div>\n            <div class=\"phone\">${selectData[i].Tel}</div>\n          </div>\n          <div class=\"ticket\">${selectData[i].Ticketinfo}</div>\n        </div> \n    `\n     }\n   }\n   row.innerHTML = str\n }\n"]}